<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Error Handling Made Easy • dreamerr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Error Handling Made Easy">
<meta property="og:description" content="Set of tools to facilitate package development and make R a more user-friendly place. Mostly for developers (or anyone who writes/shares functions). Provides a simple, powerful and flexible way to check the arguments passed to functions. 
    The developer can easily describe the type of argument needed. If the user provides a wrong argument, then an informative error message is prompted with the requested type and the problem clearly stated--saving the user a lot of time in debugging. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">dreamerr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/dreamerr_introduction.html">dreamerr: Error Handling Made Easy</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lrberge/dreamerr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="dreamerr-error-handling-made-easy">dreamerr: Error Handling Made Easy<a class="anchor" aria-label="anchor" href="#dreamerr-error-handling-made-easy"></a>
</h1></div>
<p><a href="https://cran.r-project.org/web/checks/check_results_dreamerr.html" class="external-link"><img src="https://www.r-pkg.org/badges/version/dreamerr" alt="CRAN status"></a> <a href="https://cran.r-project.org/package=dreamerr" class="external-link"><img src="http://www.r-pkg.org/badges/version/dreamerr" alt="Version"></a> <a href="https://ipub.com/dev-corner/apps/r-package-downloads/" class="external-link"> <img src="https://cranlogs.r-pkg.org/badges/dreamerr" alt="Downloads"></a></p>
<p>This package is addressed to developers or anyone writing functions (therefore almost everyone).</p>
<p>It intends to increase R’s user-friendliness and has two main objectives:</p>
<ol style="list-style-type: decimal">
<li>to provide to the developer a simple and intuitive, yet powerful and flexible, way to check the arguments passed to a function</li>
<li>to offer informative error messages to the user, in the case s/he passes arguments of the wrong type, stating clearly the problem, therefore saving their precious time in debugging</li>
</ol>
<p>These two goals can be achieved with a single line: <code>check_arg(arg_name, "expected type")</code>.</p>
<p>This package aims to be the end of R’s sometimes cryptic error messages, like the infamous</p>
<pre><code>Error in xj[i] : invalid subscript type 'closure'</code></pre>
<p>Below is a motivating example, for more details see the <a href="https://CRAN.R-project.org/package=dreamerr/vignettes/dreamerr_introduction.html" class="external-link">introduction</a>.</p>
<div class="section level2">
<h2 id="motivating-example">Motivating example<a class="anchor" aria-label="anchor" href="#motivating-example"></a>
</h2>
<p>To illustrate the usefulness, let’s rewrite the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function with some error handling and compare the results without/with error handling. In this simple example, we just add argument checking to the first two arguments of <code>lm</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_check</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="co"># data: can be missing, if provided, it must be a data.frame or a list with names</span></span>
<span>  <span class="co"># (a data.frame is a named list, but the two types are added for clarity)</span></span>
<span>  <span class="fu"><a href="reference/check_arg.html">check_arg</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"data.frame | named list"</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="co"># formula: </span></span>
<span>  <span class="co"># - must be a two-sided formula (ts)</span></span>
<span>  <span class="co"># - must be given by the user (mbt: must be there)</span></span>
<span>  <span class="co"># - the variables of the formula must be in the data set or in the environment (var(data, env))</span></span>
<span>  <span class="fu"><a href="reference/check_arg.html">check_arg</a></span><span class="op">(</span><span class="va">formula</span>, <span class="st">"ts formula var(data, env) mbt"</span>, .data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Now the call to lm</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>As we can see each argument is checked with one line, and the types are rather explicit since natural language is used.</p>
<p>Now let’s compare the two functions. First without error handling (<code>lm</code>’s default):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No argument</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in terms.formula(formula, data = data) : </span></span>
<span><span class="co">#&gt;   argument is not a valid model</span></span>
<span></span>
<span><span class="co"># Problems in the formula</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="op">~</span><span class="va">Sepal.Width</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) : </span></span>
<span><span class="co">#&gt;   incompatible dimensions</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in formula.default(object, env = baseenv()) : invalid formula</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="st">"a"</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in 1 + "a" : non-numeric argument to binary operator</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">moien</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in stats::model.frame(formula = moien, data = iris, drop.unused.levels = TRUE) : </span></span>
<span><span class="co">#&gt;   object 'moien' not found</span></span>
<span></span>
<span><span class="co"># Problem in the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">~</span><span class="va">Sepal.Width</span>, <span class="va">pt</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in as.data.frame.default(data, optional = TRUE) : </span></span>
<span><span class="co">#&gt;   cannot coerce class ‘"function"’ to a data.frame</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in eval(predvars, data, env) : </span></span>
<span><span class="co">#&gt;   numeric 'envir' arg not of length one</span></span>
<span></span>
<span><span class="co"># Mistake in the variable name</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sopal.Length</span><span class="op">~</span><span class="va">Sepal.Width</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in eval(predvars, data, env) : object 'Sopal.Length' not found</span></span></code></pre></div>
<p>As we can see, the error messages are not really explicit. It’s not easy to find: i) what the problem is, ii) which function really drives the error, iii) which argument is involved. It is therefore at best difficult, at worst impossible, to solve the problem from the error messages.</p>
<p>Now with error handling:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No argument</span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check():</span></span>
<span><span class="co">#&gt;  Argument 'formula' is required. Problem: it is missing.</span></span>
<span></span>
<span><span class="co"># Problems in the formula</span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="op">~</span><span class="va">Sepal.Width</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check(~Sepal.Width, iris):</span></span>
<span><span class="co">#&gt;  Argument 'formula' must be a two-sided formula. Problem: it is currently only one-sided.</span></span>
<span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check(1 + 1, iris):</span></span>
<span><span class="co">#&gt;  Argument 'formula' must be a two-sided formula. Problem: it is not a formula (instead it is a vector).</span></span>
<span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="st">"a"</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check(1 + "a", iris):</span></span>
<span><span class="co">#&gt;  Argument 'formula' (equal to '1 + "a"') could not be evaluated. Problem: non-numeric argument to binary operator.</span></span>
<span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="va">moien</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check(moien, iris):</span></span>
<span><span class="co">#&gt;  Argument 'formula' (equal to 'moien') could not be evaluated. Problem: object 'moien' not found.</span></span>
<span></span>
<span><span class="co"># Problem in the data</span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>, <span class="va">pt</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check(Sepal.Length ~ Sepal.Width, pt):</span></span>
<span><span class="co">#&gt;  Argument 'data' must be either: i) a data.frame, or ii) a named list. Problem: it is not a data.frame nor a list</span></span>
<span><span class="co">#&gt; (instead it is a function).</span></span>
<span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check(Sepal.Length ~ Sepal.Width, 1:...:</span></span>
<span><span class="co">#&gt;  Argument 'data' must be either: i) a data.frame, or ii) a named list. Problem: it is not a data.frame nor a list</span></span>
<span><span class="co">#&gt; (instead it is a vector).</span></span>
<span></span>
<span><span class="co"># Mistake in the variable name</span></span>
<span><span class="fu">lm_check</span><span class="op">(</span><span class="va">Sopal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>, <span class="va">iris</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error : in lm_check(Sopal.Length ~ Sepal.Width, iris):</span></span>
<span><span class="co">#&gt;  The argument 'formula' is a formula whose variables must be in the data set (given in argument 'data') or in the</span></span>
<span><span class="co">#&gt; environment. Problem: the variable 'Sopal.Length' isn't there.</span></span></code></pre></div>
<p>Now the error messages are explicit: we know where the problem comes from, the function <code>lm_check</code> is always shown as the root cause of the problem. The problematic argument is also explicitly mentioned. What the argument is expected to be is reminded and the mismatch with the actual argument is clearly mentioned after <code>Problem:</code>. Note that even nasty evaluation problems are caught.</p>
<p>Debugging a call to <code>lm_check</code> is a piece of cake (especially compared to a direct call to <code>lm</code>): a lot of time is saved, the function looks a lot more user-friendly… with just two damn lines of code.</p>
</div>
<div class="section level2">
<h2 id="a-note-on-performance">A note on performance<a class="anchor" aria-label="anchor" href="#a-note-on-performance"></a>
</h2>
<p>You may wonder: how much argument checking would slow down my code? Well, not much. Even not at all to be honest.</p>
<p>Although the function <code>check_arg</code> supports literally over hundreds of different types, it has been highly optimized, meaning its performance cost is close to 0. Talking numbers, in a moderately slow computer (2.6GHz) it is in the ballpark of 20 micro seconds for missing arguments (i.e. not provided by the user) and of 70 micro seconds for simple checks of non-missing arguments. So you end up with a cost of 1s if you check 20K to 50K arguments, which seems reasonnably fast.</p>
<p>In any case, the user can always set argument checking off with <code>setDreamerr_check(FALSE)</code>. So no reason not to make your functions user-friendly!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=dreamerr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/lrberge/dreamerr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/lrberge/dreamerr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing dreamerr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Laurent Berge <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent Berge.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
